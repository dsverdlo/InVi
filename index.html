<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Visualization</title>
<style>
.overlay {
	fill: none;
	pointer-events: all;
}

.feature {
  fill: #7D7B7B;
  cursor: pointer;
}

.boundary {
	fill: none;
	stroke: #fff;
	stroke-linejoin: round;
	stroke-linecap: round;
}

text {
  font: 10px sans-serif;
  pointer-events: none;
  text-shadow: 0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff;
}
</style>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
</head>
<body>
	<script>
	
		var width = 1100, height = 600;
		
		var projection = d3.geo.mercator().translate([ 0, 0 ]).scale(
				width / 2 / Math.PI);  
		
		var zoom = d3.behavior.zoom().scaleExtent([ 1, 8 ]).on("zoom", move);

		var path = d3.geo.path().projection(projection);

		var svg = d3.select("body").append("svg").attr("width", width).attr(
				"height", height).append("g").attr("transform",
				"translate(" + width / 2 + "," + height / 2 + ")").call(zoom);
		
		var g = svg.append("g");

		svg.append("rect").attr("class", "overlay").attr("x", -width / 2).attr(
				"y", -height / 2).attr("width", width).attr("height", height);
		d3.json("countries.topo.json", function(error, world) {
			g.selectAll("path")
				.data(topojson.feature(world, world.objects.countries).features)
				.enter().append("path")
				      .attr("d", path)
				      .attr("class", "feature");

			g.append("path").datum(
					topojson.mesh(world, world.objects.countries,
							function(a, b) {
								return a !== b;
							})).attr("class", "boundary").attr("d", path);
			
		}); 

		d3.json("circles.test.json", function(data) {
			g.selectAll("circle")
			 .data(data)
			 .enter().append("circle")
			            .attr("cx", function (d) { return d.x_axis })
			            .attr("cy", function (d) { return d.y_axis })
			            .attr("r", function(d) { return d.radius })
			            .style("stroke", "white")
			            .style("fill", "steelblue");

			g.selectAll("text")
			 .data(data)
			 .enter().append("text")
			            .text(function (d) { return d.name })
			            .attr("x", function (d) { return (d.x_axis + d.radius + 1) })
			            .attr("y", function (d) { return (d.y_axis + 2) });
		});
			
		function move() {
			var t = d3.event.translate, s = d3.event.scale;
			t[0] = Math.min(width / 2 * (s - 1), Math.max(width / 2 * (1 - s),
					t[0]));
			t[1] = Math.min(height / 2 * (s - 1) + 230 * s, Math.max(height / 2
					* (1 - s) - 230 * s, t[1]));
			zoom.translate(t);
			g.style("stroke-width", 1 / s).attr("transform",
					"translate(" + t + ")scale(" + s + ")"); 
		};

	</script>
</body>
</html>